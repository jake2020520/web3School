# Solidity å…¨å±€å˜é‡

> [é£ä¹¦æ–‡æ¡£åœ°å€](https://ncnlo95gua0y.feishu.cn/docx/Z8B3dQnbNoSzmGxJwg5cHivqnah?from=from_copylink)

## 1. ä»€ä¹ˆæ˜¯å…¨å±€å˜é‡ï¼Ÿ
Solidity æä¾›äº†ä¸€äº›å†…ç½®çš„ å…¨å±€å˜é‡ï¼ˆGlobal Variablesï¼‰ï¼Œç”¨äºè®¿é—®åŒºå—é“¾çŠ¶æ€ã€äº¤æ˜“ä¿¡æ¯ç­‰æ•°æ®ã€‚è¿™äº›å˜é‡ä¸éœ€è¦é¢å¤–å£°æ˜ï¼Œå¯ä»¥åœ¨æ™ºèƒ½åˆçº¦ä¸­ç›´æ¥è°ƒç”¨ã€‚
## 2. ä¸»è¦å…¨å±€å˜é‡åˆ†ç±»
Solidity å…¨å±€å˜é‡ä¸»è¦åˆ†ä¸ºä»¥ä¸‹å‡ ç±»ï¼š

### 2.1 åŒºå—ä¿¡æ¯ï¼ˆBlock Informationï¼‰
![image](https://github.com/user-attachments/assets/0dc032f5-7217-47bd-b7d6-855c256a79a4)


ç¤ºä¾‹ï¼šè·å–å½“å‰åŒºå—å·å’Œæ—¶é—´æˆ³
```solidity
contract BlockInfo {
    function getBlockDetails() public view returns (uint, uint) {
        return (block.number, block.timestamp);
    }
}
```

### 2.2 äº¤æ˜“ä¿¡æ¯ï¼ˆTransaction Informationï¼‰
![image](https://github.com/user-attachments/assets/406f831f-e8ef-4da7-8a70-d98698801eba)

âš ï¸ æ³¨æ„ï¼štx.origin å¯èƒ½å¯¼è‡´å®‰å…¨æ¼æ´ï¼Œé¿å…ç”¨äºèº«ä»½éªŒè¯ï¼
ç¤ºä¾‹ï¼šæ£€æŸ¥äº¤æ˜“å‘èµ·è€…
contract TxInfo {
    function getTxOrigin() public view returns (address) {
        return tx.origin;
    }
}

### 2.3 æ¶ˆæ¯ä¿¡æ¯ï¼ˆMessage Informationï¼‰
![image](https://github.com/user-attachments/assets/ef9a1e72-3c64-475b-81cf-8a6ecac84aff)

ç¤ºä¾‹ï¼šè·å–è°ƒç”¨è€…åœ°å€å’Œå‘é€çš„ ETH æ•°é‡
```solidity
contract MessageInfo {
    function getMessageDetails() public payable returns (address, uint) {
        return (msg.sender, msg.value);
    }
}
```

### 2.4 ä»¥å¤ªåŠç¯å¢ƒä¿¡æ¯ï¼ˆEthereum Environment Informationï¼‰
![image](https://github.com/user-attachments/assets/84b254ae-cd50-4534-ae6a-c8d40a49b68d)


ç¤ºä¾‹ï¼šè·å–å½“å‰åˆçº¦çš„åœ°å€å’Œä½™é¢
```solidity
contract ContractInfo {
    function getContractDetails() public view returns (address, uint) {
        return (address(this), address(this).balance);
    }
}
```

### 2.5 this å…³é”®å­—

this å…³é”®å­—ç”¨äºå¼•ç”¨å½“å‰åˆçº¦çš„å®ä¾‹ã€‚å®ƒå¯ä»¥ç”¨äºï¼š
1. è·å–å½“å‰åˆçº¦çš„åœ°å€ã€‚
2. åœ¨åˆçº¦å†…éƒ¨è°ƒç”¨è‡ªèº«çš„å‡½æ•°ï¼ˆä½†ä¼šåˆ›å»ºæ–°çš„äº¤æ˜“ï¼‰ã€‚
3. è®¿é—®å½“å‰åˆçº¦çš„ balanceã€‚
ç¤ºä¾‹ï¼šä½¿ç”¨ this å…³é”®å­—
```solidity
contract ThisExample {
    function getContractAddress() public view returns (address) {
        return address(this);
    }

    function getContractBalance() public view returns (uint) {
        return address(this).balance;
    }
}
```

æ³¨æ„äº‹é¡¹ï¼š
- this å…³é”®å­—è°ƒç”¨åˆçº¦è‡ªèº«çš„å‡½æ•°æ—¶ï¼Œä¼šè§¦å‘æ–°çš„äº¤æ˜“ï¼Œå› æ­¤ä¼šæ¶ˆè€—é¢å¤–çš„ gasã€‚
- this.balance è·å–çš„æ˜¯åˆçº¦çš„ ETH ä½™é¢ï¼Œè€Œ msg.sender.balance å¯ä»¥ç”¨äºè·å–è°ƒç”¨è€…çš„ä½™é¢ã€‚

### 2.6 å…¶ä»–ç‰¹æ®Šå…¨å±€å˜é‡
![image](https://github.com/user-attachments/assets/019338ae-feac-42fa-8872-d7dd619346c1)

ç¤ºä¾‹ï¼šä½¿ç”¨ keccak256 è®¡ç®—å“ˆå¸Œå€¼
```solidity
contract HashExample {
    function getHash(string memory input) public pure returns (bytes32) {
        return keccak256(abi.encodePacked(input));
    }
}
```

3. åº”ç”¨åœºæ™¯
âœ… éšæœºæ•°ç”Ÿæˆï¼ˆâš ï¸ ä»…é™ä½å®‰å…¨æ€§ç”¨é€”ï¼‰
```solidity
function getRandomNumber() public view returns (uint) {
    return uint(keccak256(abi.encodePacked(block.timestamp, msg.sender))) % 100;
}
```

âœ… æ”¯ä»˜åˆçº¦
```solidity
contract Payment {
    function pay() public payable {}
    function getBalance() public view returns (uint) {
        return address(this).balance;
    }
}
```

âœ… å®‰å…¨èº«ä»½éªŒè¯ï¼ˆé¿å… tx.originï¼‰
```solidity
contract Auth {
    address public owner;
    constructor() { owner = msg.sender; }
    function isOwner() public view returns (bool) {
        return msg.sender == owner;
    }
}
```

4. æ€»ç»“
- Solidity æä¾›äº†è®¸å¤š å…¨å±€å˜é‡ï¼Œå¯ä»¥è®¿é—® åŒºå—é“¾çŠ¶æ€ã€äº¤æ˜“ä¿¡æ¯ã€æ¶ˆæ¯ä¿¡æ¯ç­‰ã€‚
- this å…³é”®å­—å¯ç”¨äºå¼•ç”¨å½“å‰åˆçº¦åœ°å€ã€ä½™é¢æˆ–è°ƒç”¨è‡ªèº«å‡½æ•°ï¼ˆä¼šæ¶ˆè€—é¢å¤– gasï¼‰ã€‚
- æ•°ç»„ã€å“ˆå¸Œã€åŠ å¯†å‡½æ•° ä¹Ÿæ˜¯ Solidity é‡è¦çš„å…¨å±€åŠŸèƒ½ã€‚
- åœ¨å¼€å‘åˆçº¦æ—¶ï¼Œåº” æ­£ç¡®ä½¿ç”¨å…¨å±€å˜é‡ï¼Œé¿å… å®‰å…¨éšæ‚£ï¼ˆå¦‚ tx.originï¼‰ã€‚

---
ğŸ“Œ é—®é¢˜æ€è€ƒ
1. ä¸ºä»€ä¹ˆ tx.origin ä¸å®‰å…¨ï¼Ÿ
2. å¦‚ä½•ä½¿ç”¨ block.timestamp ç”Ÿæˆéšæœºæ•°ï¼Ÿ
3. gasleft() åœ¨åˆçº¦æ‰§è¡Œè¿‡ç¨‹ä¸­ä¼šå¦‚ä½•å˜åŒ–ï¼Ÿ
